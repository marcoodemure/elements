<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Interactive 3D T-Shirt</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: transparent; /* fully transparent for embedding */
    overflow: hidden;
    width: 100%;
    height: 100%;
  }

  .scene {
    perspective: 800px;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .card {
    transform-style: preserve-3d;
    cursor: grab;
    width: 30vw;        /* responsive */
    max-width: 400px;
    min-width: 200px;
  }

  .card img {
    width: 100%;
    display: block;
    filter: drop-shadow(0 25px 20px rgba(0,0,0,0.25));
    box-shadow: 0 20px 30px rgba(0,0,0,0.3);
    transition: transform 0.2s ease-out, filter 0.2s ease-out;
    user-select: none;
    -webkit-user-drag: none;
    user-drag: none;
  }

  .card img:hover {
    transform: scale(1.05);
  }
</style>
</head>
<body>
  <div class="scene">
    <div class="card" id="card">
      <img src="shirt.png" alt="T-shirt" id="shirt-img" draggable="false" />
    </div>
  </div>

<script>
const card = document.getElementById("card");
const img = document.getElementById("shirt-img");

// Rotation
let angleY = 0;
let tiltX = 0;
let tiltY = 0;

// Drag
let isDragging = false;
let startX = 0;
let startAngle = 0;

// Hover/tilt
let isHovering = false;
let isMoving = false;

// Zoom with easing
let scale = 1;
let offsetX = 0;
let offsetY = 0;
let targetScale = 1;
let targetOffsetX = 0;
let targetOffsetY = 0;

const BASE_SCALE = 1; // default size
const MAX_SCALE = 2.0; // maximum zoom-in
const zoomEase = 0.1;

// Disable native drag
img.addEventListener("dragstart", e => e.preventDefault());

// Clamp helper
function clamp(value, min, max) {
  return Math.min(Math.max(value, min), max);
}

// Mouse movement for tilt
let moveTimeout;
document.addEventListener("mousemove", e => {
  if (!isDragging && isHovering) {
    tiltX = clamp((window.innerHeight / 2 - e.clientY) / 20, -15, 15);
    tiltY = clamp((e.clientX - window.innerWidth / 2) / 20, -15, 15);
  }
  isMoving = true;
  clearTimeout(moveTimeout);
  moveTimeout = setTimeout(() => (isMoving = false), 100);
});

card.addEventListener("mouseenter", () => (isHovering = true));
card.addEventListener("mouseleave", () => {
  isHovering = false;
  tiltX = 0;
  tiltY = 0;
});

// Drag rotation
card.addEventListener("mousedown", e => {
  isDragging = true;
  startX = e.clientX;
  startAngle = angleY;
  card.style.cursor = "grabbing";
});

document.addEventListener("mousemove", e => {
  if (!isDragging) return;
  const deltaX = e.clientX - startX;
  angleY = startAngle + deltaX / 2;
});

document.addEventListener("mouseup", () => {
  if (isDragging) {
    isDragging = false;
    card.style.cursor = "grab";
  }
});

// Touch drag
card.addEventListener("touchstart", e => {
  isDragging = true;
  startX = e.touches[0].clientX;
  startAngle = angleY;
});

document.addEventListener("touchmove", e => {
  if (!isDragging) return;
  const deltaX = e.touches[0].clientX - startX;
  angleY = startAngle + deltaX / 2;
});

document.addEventListener("touchend", () => {
  isDragging = false;
});

// Scroll-to-zoom (zoom-in follows mouse, zoom-out returns to default)
card.addEventListener("wheel", e => {
  e.preventDefault();
  const zoomIntensity = 0.0015;
  const oldScale = targetScale;

  if (e.deltaY < 0) {
    // Zoom in: mouse-centered
    targetScale += -e.deltaY * zoomIntensity; 
    targetScale = clamp(targetScale, BASE_SCALE, MAX_SCALE);

    const rect = card.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    targetOffsetX += (mouseX - rect.width / 2) * (1 - targetScale / oldScale);
    targetOffsetY += (mouseY - rect.height / 2) * (1 - targetScale / oldScale);
  } else {
    // Zoom out: return to default size & center
    targetScale = BASE_SCALE;
    targetOffsetX = 0;
    targetOffsetY = 0;
  }
}, { passive: false });

// Animation loop
function animate() {
  if (!isDragging && !isHovering && !isMoving) {
    angleY += 0.3; // auto-spin
  }

  // Smoothly interpolate scale and offsets
  scale += (targetScale - scale) * zoomEase;
  offsetX += (targetOffsetX - offsetX) * zoomEase;
  offsetY += (targetOffsetY - offsetY) * zoomEase;

  card.style.transform = `
    translate(${offsetX}px, ${offsetY}px)
    rotateY(${angleY + tiltY}deg)
    rotateX(${tiltX}deg)
    scale(${scale})
  `;

  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
